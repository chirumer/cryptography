<svg width="800" height="600" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;display=swap');
      text { font-family: 'Roboto', sans-serif; fill: #151313; }
      .title { font-size: 24px; font-weight: bold; text-anchor: middle; }
      .subtitle { font-size: 14px; text-anchor: middle; fill: #584B47; }
      .label { font-size: 14px; text-anchor: middle; }
      .label-left { font-size: 14px; text-anchor: start; }
      .box { fill: #F8FBFB; stroke: #2C2422; stroke-width: 3; rx: 10; ry: 10; }
      .group-box { fill: none; stroke: #6B6967; stroke-width: 2; stroke-dasharray: 5,5; rx: 10; ry: 10; }
      .arrow { stroke: #584B47; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .emoji { font-size: 30px; text-anchor: middle; }
      .bar-red { fill: #C07864; }
      .bar-gray { fill: #BEBCB8; }
        </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#584B47" />
    </marker>
        
  </defs>
  <rect width="100%" height="100%" fill="none" /><text x="400" y="40" class="title">LDP Protocol Attack Skewing the Frequently Used Emoji Statistic</text><g transform="translate(100, 200)">
    <!-- Group Box -->
    <rect x="-100" y="-60" width="200" height="120" class="group-box" />
    
    <text x="0" y="-30" class="label" font-weight="bold">Regular Users</text>
    <text x="0" y="-10" class="subtitle">(Honest Data)</text>
    <g transform="translate(-70,10) scale(0.0390625)"><path fill="#584B47" d="M32 32c17.7 0 32 14.3 32 32V400c0 8.8 7.2 16 16 16H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H80c-44.2 0-80-35.8-80-80V64C0 46.3 14.3 32 32 32zM160 224c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32s-32-14.3-32-32V256c0-17.7 14.3-32 32-32zm128-64V320c0 17.7-14.3 32-32 32s-32-14.3-32-32V160c0-17.7 14.3-32 32-32s32 14.3 32 32zm64 32c17.7 0 32 14.3 32 32v96c0 17.7-14.3 32-32 32s-32-14.3-32-32V224c0-17.7 14.3-32 32-32zM480 96V320c0 17.7-14.3 32-32 32s-32-14.3-32-32V96c0-17.7 14.3-32 32-32s32 14.3 32 32z"/></g>
    <g transform="translate(-30,10) scale(0.0390625)"><path fill="#584B47" d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9z"/></g>
    <g transform="translate(10,10) scale(0.0390625)"><path fill="#584B47" d="M64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V160H256c-17.7 0-32-14.3-32-32V0H64zM256 0V128H384L256 0zM112 256H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></g>
    <g transform="translate(50,10) scale(0.0390625)"><path fill="#584B47" d="M32 32c17.7 0 32 14.3 32 32V400c0 8.8 7.2 16 16 16H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H80c-44.2 0-80-35.8-80-80V64C0 46.3 14.3 32 32 32zM160 224c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32s-32-14.3-32-32V256c0-17.7 14.3-32 32-32zm128-64V320c0 17.7-14.3 32-32 32s-32-14.3-32-32V160c0-17.7 14.3-32 32-32s32 14.3 32 32zm64 32c17.7 0 32 14.3 32 32v96c0 17.7-14.3 32-32 32s-32-14.3-32-32V224c0-17.7 14.3-32 32-32zM480 96V320c0 17.7-14.3 32-32 32s-32-14.3-32-32V96c0-17.7 14.3-32 32-32s32 14.3 32 32z"/></g>
    <text x="0" y="50" class="label">Varied Emojis</text>
        </g><g transform="translate(400, 200)">
    <rect x="-100" y="-60" width="200" height="120" class="box" />
    <text x="0" y="-30" class="label" font-weight="bold">Apple Server</text>
    <text x="0" y="-10" class="subtitle">(Data Collection)</text>
    
    <!-- Privacy Filter Inner Box -->
    <rect x="-80" y="10" width="160" height="40" fill="#BEBCB8" opacity="0.3" rx="5" />
    <text x="0" y="35" class="label">LDP Decoding</text>
        </g><g transform="translate(700, 200)">
    <!-- Group Box -->
    <rect x="-100" y="-60" width="200" height="120" class="group-box" />

    <text x="0" y="-30" class="label" font-weight="bold">Attackers</text>
    <text x="0" y="-10" class="subtitle">(Malicious Data)</text>
    <g transform="translate(-70,10) scale(0.0390625)"><path fill="#C07864" d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"/></g>
    <g transform="translate(-30,10) scale(0.0390625)"><path fill="#C07864" d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"/></g>
    <g transform="translate(10,10) scale(0.0390625)"><path fill="#C07864" d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"/></g>
    <g transform="translate(50,10) scale(0.0390625)"><path fill="#C07864" d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"/></g>
    <text x="0" y="50" class="label" fill="#C07864">Attack Emoji</text>
        </g><path d="M 200 200 L 300 200" class="arrow" /><text x="250.0" y="190.0" class="label" font-size="12px" fill="#584B47">+ ε-LDP noise</text><path d="M 600 200 L 500 200" class="arrow" /><text x="550.0" y="190.0" class="label" font-size="12px" fill="#584B47">+ ε-LDP noise</text><path d="M 400 260 L 400 350" class="arrow" /><g transform="translate(400, 450)">
    <!-- Dynamically calculated box: padding=20px -->
    <rect x="-155" y="-90" width="435" height="210" class="group-box" />

    <text x="0" y="-50" class="title" font-size="20px">Emoji Frequency Statistic</text>
    
    <!-- Bar 1: Manipulated -->
    <g transform="translate(-135,-30) scale(0.05859375)"><path fill="#C07864" d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"/></g>
    <rect x="-90" y="-30" width="250" height="30" class="bar-red" />
    <text x="180" y="-15" class="label-left" dominant-baseline="middle">Manipulated</text>
    <!-- Bar 2: Normal -->
    <g transform="translate(-135,20) scale(0.05859375)"><path fill="#584B47" d="M32 32c17.7 0 32 14.3 32 32V400c0 8.8 7.2 16 16 16H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H80c-44.2 0-80-35.8-80-80V64C0 46.3 14.3 32 32 32zM160 224c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32s-32-14.3-32-32V256c0-17.7 14.3-32 32-32zm128-64V320c0 17.7-14.3 32-32 32s-32-14.3-32-32V160c0-17.7 14.3-32 32-32s32 14.3 32 32zm64 32c17.7 0 32 14.3 32 32v96c0 17.7-14.3 32-32 32s-32-14.3-32-32V224c0-17.7 14.3-32 32-32zM480 96V320c0 17.7-14.3 32-32 32s-32-14.3-32-32V96c0-17.7 14.3-32 32-32s32 14.3 32 32z"/></g>
    <rect x="-90" y="20" width="150" height="30" class="bar-gray" />
    <text x="80" y="35" class="label-left" dominant-baseline="middle">Normal</text>
    <!-- Bar 3: Normal -->
    <g transform="translate(-135,70) scale(0.05859375)"><path fill="#584B47" d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9z"/></g>
    <rect x="-90" y="70" width="80" height="30" class="bar-gray" />
    <text x="10" y="85" class="label-left" dominant-baseline="middle">Normal</text>
        </g>
</svg>